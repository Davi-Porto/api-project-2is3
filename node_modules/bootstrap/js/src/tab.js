8 * 3.8),
(45,'Madeira','M',0.25 * 3.8),
(87,'Cano','M',1.97 * 3.8),
(77,'Papel','M',1.05 * 3.8);

select * from tb_produto;

insert into tb_pedido values
(121,'2023-02-01',410,310),
(97,'2023-02-01',720,101),
(101,'2023-03-07',720,101),
(137,'2023-06-06',720,720),
(148,'2023-06-06',720,101),
(189,'2023-06-06',870,213),
(104,'2023-07-09',110,101),
(203,'2023-07-09',830,250),
(98,'2022-12-12',410,310),
(143,'2022-12-13',201,101),
(105,'2022-12-13',180,240),
(111,'2023-02-01',260,240),
(103,'2023-02-01',260,11),
(91,'2023-03-07',260,11),
(138,'2023-06-06',260,11),
(108,'2023-06-06',290,310),
(119,'2023-03-07',390,250),
(172,'2023-03-07',410,11);

insert into item_pedido values
(121,25,10),
(121,31,35),
(97,77,20),
(101,31,9),
(101,78,18),
(101,13,5),
(98,77,5),
(148,45,8),
(148,31,7),
(148,77,3),
(148,25,10),
(148,78,30),
(104,53,32),
(203,31,6),
(189,78,45),
(143,31,20),
(143,78,10),
(105,78,10),
(111,25,10),
(111,78,70),
(103,53,37),
(91,77,40),
(138,22,10),
(138,77,35),
(138,53,18),
(108,13,17),
(119,77,40),
(119,13,6),
(119,22,10),
(119,53,43),
(137,13,8);

create table if not exists tb_uf(
sg_uf char(2) not null, 
nm_uf varchar(30),
constraint pk_uf
	primary key(sg_uf))
    engine InnoDB;
    
create table if not exists tb_cidade(
cd_cidade int not null,
nm_cidade varchar(40),
sg_uf char(2),
constraint pk_cidade
	primary key(cd_cidade),
constraint fk_cidade_uf
	foreign key(sg_uf)
		references tb_uf(sg_uf))
        engine InnoDB;
        
Insert Into tb_uf Values
('AC','Acre'),  
('AL','Alagoas'),
('AM','Amazonas'),
('AP','Amapá'),
('BA','Bahia'),
('CE','Ceará'),
('DF','Distrito Federal'),
('ES','Espírito Santo'),
('GO','Goiás'),
('MA','Maranhão'),
('MG','Minas Gerais'),
('MS','Mato Grosso do Sul'),
('MT','Mato Grosso'),
('PA','Pará'),
('PB','Paraíba'),
('PE','Pernambuco'),
('PI','Piauí'),
('PR','Paraná'),
('RJ','Rio de Janeiro'),
('RN','Rio Grande do Norte'),
('RO','Rondônia'),
('RR','Roraima'),
('RS','Rio Grande do Sul'),
('SC','Santa Catarina'),
('SE','Sergipe'),
('SP','São Paulo'),
('TO','Tocantins');

insert into tb_cidade VALUES
(101,'São Paulo','SP'),
(102,'Belo Horizonte','MG'),
(103,'Florianopolis','SC'),
(104,'Londrina','PR'),
(105,'Rio de Janeiro','RJ'),
(106,'Niteroi','RJ'),
(107,'Curitiba','PR'),
(108,'Salvador','BA'),
(109,'Uberaba','MG'),
(110,'Brasilia','DF');

select * from tb_cliente;

alter table tb_cliente add cd_cidade int;

alter table tb_cliente add
	constraint fk_cliente_cidade
		foreign key(cd_cidade)
			references tb_cidade(cd_cidade);
            
update tb_cliente set cd_cidade = 106 where  cd_cliente = 720;
        
update tb_cliente set cd_cidade = 101 where  cd_cliente = 870;
update tb_cliente set cd_cidade = 107 where  cd_cliente = 110;
update tb_cliente set cd_cidade = 102 where  cd_cliente = 222;
update tb_cliente set cd_cidade = 101 where  cd_cliente = 830;
update tb_cliente set cd_cidade = 105 where  cd_cliente = 103;
update tb_cliente set cd_cidade = 105 where  cd_cliente = 410;
update tb_cliente set cd_cidade = 101 where  cd_cliente = 201;
update tb_cliente set cd_cidade = 104 where  cd_cliente = 157;
update tb_cliente set cd_cidade = 103 where  cd_cliente = 180;
update tb_cliente set cd_cidade = 106 where  cd_cliente = 260;
update tb_cliente set cd_cidade = 101 where  cd_cliente = 290;
update tb_cliente set cd_cidade = 109 where  cd_cliente = 390;
update tb_cliente set cd_cidade = 110 where  cd_cliente = 234;
update tb_cliente set cd_cidade = 108 where  cd_cliente = 130;

select * from tb_cliente;

select * from tb_revendedor;

alter table tb_revendedor add cd_cpf char(11);

alter table tb_revendedor add vl_salario decimal(9,2);

update tb_revendedor
	set cd_cpf = '12345678989' , vl_salario = 4556.89
		where cd_revendedor = 011;
        
update tb_revendedor set cd_cpf = '98765432134' , 
    vl_salario = 5674.34 where cd_revendedor = 240;
update tb_revendedor set cd_cpf = '98543213476' , 
    vl_salario = 1675.14 where cd_revendedor = 720;
update tb_revendedor set cd_cpf = '34987654321' , 
    vl_salario = 1124.34 where cd_revendedor = 213;
update tb_revendedor set cd_cpf = '87634932154' , 
    vl_salario = 4324.19 where cd_revendedor = 101;
update tb_revendedor set cd_cpf = '15487634932' , 
    vl_salario = 2724.20 where cd_revendedor = 310;
update tb_revendedor set cd_cpf = '63415932487' , 
    vl_salario = 3241.25 where cd_revendedor = 250;
    
select (9+((78/2)*14/(52+3)))*5;

select acos(0.5);

select asin(0.5);

select degrees(asin(0.5));

select mod(5,2);

select pi() + 0.00000000000;

select round(1.9);

select round(1.3);

select ceil(1.3);

select sqrt(25);

select bin(194168042);

select hex(194168042);

select nm_revendedor, sg_comissao, vl_salario,
	format(vl_salario * 1.05 + 200,2) as 'Salario comissionado', vl_salario - (format(vl_salario * 1.05 + 200,2)) as diferença 
		from tb_revendedor
			where sg_comissao = 'a';
            
desc tb_produto;
            
select nm_produto as 'Nome do Produto' ,format(vl_produto,2) as 'Valor Produto', format(vl_produto * 1.10,2) as 'Novo Valor'
	from tb_produto;
    
select datediff(curdate(), '2005-1-31') / 365;

select dt_pedido, datediff(curdate(), dt_pedido),
day(dt_pedido), month(dt_pedido), year(dt_pedido),
dayname(dt_pedido), monthname(dt_pedido), dayofweek(dt_pedido) -- todo comando executado entre o select e o from são funções
	from tb_pedido;
    
select dt_pedido, dt_pedido + interval '15' day
		from tb_pedido;
        
select dt_pedido, dt_pedido + interval '5' month
		from tb_pedido;

-- SUBQUERY - SUBSELECT  SELECT ENCADIADO - SELECT ENCAPSULADO

select nm_produto
	from tb_produto 
		where cd_produto
			in (select cd_produto
					from item_pedido
						where qt_produto = 10);

select nm_revendedor, vl_salario
	from tb_revendedor 
		where vl_salario >
			(select avg(vl_salario)
				from tb_revendedor);
                
select * from tb_cliente;

select nm_cliente, (select sg_uf from tb_cidade as ci
						where ci.cd_cidade = cl.cd_cidade) as UF
							from tb_cliente as cl;
                            
	select 	prod.cd_produto as Produto,
			nm_produto as 'Nome do produto',	
            vl_produto as 'Valor do Produto',
			vl_produto * tempquant.soma as 'Valor total adquirido',
            (select sum(qt_produto) from item_pedido 
			where cd_produto = prod.cd_produto) as 'Quantidade de Produtos'
				from tb_produto as prod join (select cd_produto,
                (select sum(qt_produto) from item_pedido
					where cd_produto = prod2.cd_produto) as soma
						from tb_produto as prod2) as tempquant 
							on tempquant.cd_produto = prod.cd_produto
								where vl_produto > (select avg(vl_produto)
														from tb_produto);
                                                        
select cli.nm_cliente, cid.nm_cidade, prod.nm_produto
	from tb_cliente as cli join tb_cidade as cid 
		on cli.cd_cidade = cid.cd_cidade
			join  tb_pedido as ped 
				on cli.cd_cliente = ped.cd_cliente
					join item_pedido as item
						on ped.cd_pedido = item.cd_pedido
							join tb_produto as prod
								on prod.cd_produto = item.cd_produto
			where cid.sg_uf = 'sp';
            
create table if not exists  tb_cliente_sp(
nm_cliente varchar(50),
nm_cidade varchar(50),
nm_produto varchar(50)
);

insert into tb_cliente_sp(nm_cliente,nm_cidade,nm_produto)
select cli.nm_cliente, cid.nm_cidade, prod.nm_produto
	from tb_cliente as cli join tb_cidade as cid 
		on cli.cd_cidade = cid.cd_cidade
			join  tb_pedido as ped 
				on cli.cd_cliente = ped.cd_cliente
					join item_pedido as item
						on ped.cd_pedido = item.cd_pedido
							join tb_produto as prod
								on prod.cd_produto = item.cd_produto
			where cid.sg_uf = 'sp';
            
select * from tb_cliente_sp;

alter table tb_cliente_sp
	add cd_produto int;
    
select * from tb_cliente_sp;

update tb_cliente_sp
	set cd_produto = (select cd_produto
						from tb_produto
							where nm_produto = 'chocolate')
	where nm_produto = 'chocolate';

update tb_cliente_sp
	set cd_produto = (select cd_produto
						from tb_produto
							where nm_produto = 'vinho')
	where nm_produto = 'vinho';
    
update tb_cliente_sp
	set cd_produto = (select cd_produto
						from tb_produto
							where nm_produto = 'ouro')
	where nm_produto = 'ouro';
    
delete from tb_cliente_sp
	where nm_cliente = (select nm_cliente
						from tb_cliente 
		where cd_cliente = 201);
        
select * from tb_cliente_sp;

create table consolidacao
select distinct nm_cliente as 'Nome do Cliente',
nm_cidade as 'Nome da cidade', sg_uf as UF,
p.cd_pedido as 'Codigo do Pedido', dt_pedido 'Data do Pedido',
nm_revendedor as 'Nome do revendedor', qt_produto 'QTDA Produto',
nm_produto as 'Nome do Produto', vl_produto as 'Preço Unitário',
pr.sg_unidade as Unidade
	from tb_cliente as c, tb_cidade ci, tb_pedido p, item_pedido ip, tb_produto pr, tb_unidade u, tb_revendedor r
where c.cd_cidade = ci.cd_cidade
	and c.cd_cliente = p.cd_cliente
		and r.cd_revendedor = p.cd_revendedor
			and p.cd_pedido = ip.cd_pedido
				and ip.cd_produto = pr.cd_produto;
                
select * from consolidacao;



create view vwSubtotal (Nome, UF , Produto, quantidade, subtotal) as 
	select c.nm_cliente, ci.sg_uf, pr.nm_produto, i.qt_produto, i.qt_produto * pr.vl_produto
		from tb_cliente as c join tb_pedido as p
			join tb_cidade as ci
				on c.cd_cidade = ci.cd_cidade
					join item_pedido as i
						on p.cd_ped